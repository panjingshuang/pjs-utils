/*!
 * @panjingshuang/pjs-utils v1.0.2
 * (c) 2014-2024 @panjingshuang/pjs-utils
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["pjs-utils"]={})}(this,(function(e){"use strict";function t(e,t){if(e)for(let n of Object.keys(t))e.style[n]=t[n];else console.log("setDomStyle cant find params dom!")}function n(e,t){if(e)for(let n of Object.keys(t))e.setAttribute(n,t[n]);else console.log("setDomStyle cant find params dom!")}function o(e){let t=document.documentElement;if(t.style["font-size"]){let n=parseInt(t.style["font-size"]);if(!Math.min(t.clientWidth,750))return;return n/100*parseInt(e)}return console.log("getPxtoRem cant find html style font-size !"),null}function i(e,t){return Math.round(Math.random()*t+e)}function l(e,t="png",n=1){return t?e.toDataURL("image/"+t,Number(n)):e.toDataURL()}var r={width:750,height:1334,designScale:2,adaptiveScale:2,clientWidth:document.documentElement.clientWidth||document.body.clientWidth,clientHeight:document.documentElement.clientHeight||document.body.clientHeight};r.adaptiveScale=r.width/r.clientWidth,e.Barrage=function(e){if(!e.id)return void console.log("function Barrage need id!");let n="barrage",o="barrage-b",l=document.getElementById(e.id);if(t(l,{position:"relative",overflow:"hidden"}),e.textSize=e.textSize||20,e.duration=e.duration||10,e.num=e.num||5,e.duration=e.duration||12,!e.content)return;let a=e.content,d=0,s=0;function c(n,o,a){let d,s=e.fontColor,c=e.textSize,u=parseInt(l.clientWidth);if(Array.isArray(s)){let e=i(0,s.length-1);console.log(e),d=s[e]}else d=s||"black";if(Array.isArray(c)){c=c[i(0,c.length-1)]/r.adaptiveScale}else c/=r.adaptiveScale;let m={position:"absolute",top:parseInt(l.clientHeight)/e.num*a+"px",left:u+"px",fontSize:c+"px",whiteSpace:"nowrap",color:d},f=document.createElement("span");return f.classList.add(o,"barrage-item"),t(f,m),f.innerHTML=n,f}function u(t,n=0,o){let i=10;e&&e.duration&&(i=e.duration),window.gsap.to(t,{x:function(e){let n=document.querySelectorAll(t);return-(parseFloat(n[e].clientWidth)+parseFloat(l.clientWidth))},duration:i,ease:"none",yoyo:!1,stagger:e.num,onComplete:function(){!function(e,t){window.gsap.to("."+e+"-"+t,{x:0,y:0,duration:0,delay:0})}(o,n);let e=n+1;e>=Math.floor(s)?u("."+o+"-0",0,o):u("."+o+"-"+e,e,o)}})}return function(){let t,i;d=a.length,s=d/2/e.num,d/2%e.num!=0&&(s+=1);for(i=0;i<Math.ceil(d/2);i++)t=c(a[i],n+"-"+Math.floor(i/e.num),i%e.num),l.appendChild(t);for(let n=0;n<Math.floor(d/2);n++)t=c(a[n+i],o+"-"+Math.floor(n/e.num),n%e.num),l.appendChild(t)}(),window.setTimeout((()=>{u("."+n+"-0",0,n),e.num>1&&window.setTimeout((()=>{u("."+o+"-0",0,o)}),1e3*e.duration/2)}),500),{destroy:function(){n="",o="",d=0,e=null,document.getElementsByClassName("barrage-item").forEach((e=>{window.gsap.killTweensOf(e)}))}}},e.TwistedEggMatter=function(e){if(!e.id)return console.log("function TwistedEggMatter need params of id "),null;if(!window.Matter)return void console.log("function TwistedEggMatter need to introduce Matter.js!");const t=e.imgs,n=o(e.ballWidth)*e.ratio,i=e.width,l=e.height,r=parseInt(e.gravityY);let a=window.Matter,d=a.Engine,s=a.Render,c=a.Runner,u=a.World,m=a.Bodies,f=a.Composite,p=d.create(),g=document.getElementById(e.id);console.log(g);let h=s.create({element:g,engine:p,options:{width:o(i),height:o(l),wireframes:!1,background:"transparent"}});p.world.gravity.x=0,p.world.gravity.y=.5;const y=[];let w=-1,x=t.length,I=[122.78585140770514,209.3235376646257,326.01634544621396,101.52559109065926,188.39323934095015,282.38697650836866],b=[183.38542746227944,230.06200548401105,207.91038110198647,279.55905905222403,326.1084787517811,296.24269011459813];for(let o=0;o<x;o++){let r=i/400*I[o],a=l/400*b[o],d=m.circle(r,a,n/2,{friction:.001,frictionAir:.005,restitution:.9,density:.05,render:{strokeStyle:"red",lineWidth:0,sprite:{texture:t[o],xScale:e.scale?e.scale:.9,yScale:e.scale?e.scale:.9}}});y.push(d)}let v=Math.min(i,l),E=v*(1/4.5*2);const S=2*Math.PI;let M,k,C,T,L,B,A;for(w=0;w<64;w++)M=S/64,k=w/64*S+M/2,C=Math.cos(k),T=Math.sin(k),L=C*E+i/2,B=T*E+l/2,W({x:L,y:B,w:.01*v,h:.4*v,options:{angle:k,isStatic:!0,density:1,render:{fillStyle:"red",strokeStyle:"transparent",lineWidth:1}}});function W({x:e=0,y:t=0,w:n=10,h:o=10,options:i={}}={}){let l=m.rectangle(e,t,n,o,i);return function(...e){u.add(p.world,...e)}(l),l}return f.add(p.world,y),s.run(h),s.lookAt(h,f.allBodies(p.world)),{start:function(e=(()=>{})){A||(A=c.create()),c.run(A,p);let t=y,n=0;for(let e=0;e<2*t.length;e++)window.setTimeout((()=>{var n;n=t[e%t.length],a.Body.applyForce(n,n.position,{x:0,y:-Math.random()*r})}),n),n+=100;window.setTimeout((()=>{c.stop(A),e()}),3*n)}}},e.canvasImgInLocal=function(e,t=(()=>{})){if(!window.html2canvas)return void console.log("function canvasImgInLocal need to introduce html2canvas.js!");let n=document.getElementById(e.canvasId);const o=n||document.documentElement.body;let i=[];e.hiddenCompIds&&(i=e.hiddenCompIds.split(",")),window.setTimeout((()=>{window.html2canvas(o,{backgroundColor:e.saveImgBgColor||null,useCORS:!0,async:!0,logging:!1,ignoreElements:e=>!!(i.length>0&&e.id&&i.indexOf(e.id)>-1)}).then((n=>{const o=l(n);if(e.repalceId){let t=document.getElementById(e.repalceId);if(t){if(t instanceof HTMLImageElement)t.src=o;else if(t instanceof HTMLCanvasElement){t.getContext("2d").drawImage(n,0,0)}}else console.log("canvas repalce dom can not find!")}t({canvas:n,url:o})}))}),e.timeOut||0)},e.clipboardCopy=async function(e,t,n){let o=document.getElementById(e),i="";i=o?o.innerHTML||o.innerText:e,!function(e){const t=document.createElement("span");t.textContent=e,t.style.whiteSpace="pre",t.style.webkitUserSelect="auto",t.style.userSelect="all",document.body.appendChild(t);const n=window.getSelection(),o=window.document.createRange();n.removeAllRanges(),o.selectNode(t),n.addRange(o);let i=!1;try{i=window.document.execCommand("copy")}finally{n.removeAllRanges(),window.document.body.removeChild(t)}if(!i)throw window.makeError();return i}(i)?n&&n():t&&t(i)},e.forEachCanReturn=(e,t)=>{for(let n of e)if(t(n))return t(n)},e.getBase64ByType=l,e.getRealPx=o,e.mergeByShallow=(e,t)=>{let n=JSON.stringify(t),o=JSON.stringify(n);for(let t in o)e[t]=o[t]},e.onLotterty=function(e){const i=[0,1,2,7,8,3,6,5,4];let l=[],r=[],a=null,d=null,s=0,c=null,u=-1,m=null;if(e.id){let r=document.getElementById(e.id);if(t(r,{display:"flex","justify-content":"space-between","align-items":"center","flex-wrap":"wrap"}),r){if(r.childNodes.length>0)return;for(let a=0;a<9;a++){let d,s,c=document.createElement("div");if(c.setAttribute("lottery_index",i[a]),e.itemWidth)d=o(e.itemWidth)+"px",s=o(e.itemHeight)+"px";else{let t=parseInt(r.offsetWidth),n=parseInt(r.offsetHeight),o=e.ratio?e.ratio:.99;d=t/3*o+"px",s=n/3*o+"px"}t(c,{display:"inline-block",position:"relative",width:d,height:s,"flex-shrink":1});let u=document.createElement("img"),m=document.createElement("img");t(u,{position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"none",zIndex:20}),t(m,{position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:1}),e.lotteryList?(e.lotteryList[a]&&(n(u,{src:e.lotteryList[a][0],lottery_status:"light"}),n(m,{src:e.lotteryList[a][1],lottery_status:"unlight"})),c.appendChild(u),c.appendChild(m)):console.log("onLottery need params lotteryList!"),l.push(c),r.appendChild(c)}}else console.log("onLottery params need id")}if(e.time=!e.time||e.time<3?3:e.time,e.times=!e.times||e.times<2?2:e.times,l.length){let n=l.sort(((e,t)=>parseInt(e.getAttribute("lottery_index"))-parseInt(t.getAttribute("lottery_index"))));r=[...n],a=r.pop(),d=a.childNodes[0],e.onclick&&d.addEventListener("click",(function(n){if(n.preventDefault(),n.stopPropagation(),a){if(e.onclick){t(d,{display:"none"}),(0,e.onclick)()}}else console.log("emitClick cant find lottery dom!")}))}function f(e){if(r.forEach((e=>{t(e.childNodes[0],{display:"none"})})),e>=0){t(r[e].childNodes[0],{display:"block"})}}function p(t,n=(()=>{})){t<0&&(t=e.thanksIndex);const o=r.length,i=o*(e.times-2)+t;if(f(s%o),i==u&&0==i)g(),n();else{const o=1e3*e.time,r=parseInt(e.time/2*1e3/i),a=parseInt(500*((l=(l=u*r)/o-1)*l*l+1)+300);m=window.setTimeout((()=>{p(t,n),s++,u++,u>=i&&(n(),g(),window.clearTimeout(m))}),a)}var l}function g(){let n={};e.LotteryTime>=1?n.display="block":n.display="none",t(d,n)}return l.forEach((n=>{let o=parseInt(n.getAttribute("lottery_index")),i=n.childNodes[0],l=n.childNodes[1];8==o?e.LotteryTime>=1?t(i,{display:"block"}):t(i,{display:"none"}):(t(i,{display:"none"}),t(l,{display:"block"}))})),{start:function(t,n=(()=>{})){const o=r.length,i=o*e.times,l=parseInt(1e3*e.time/i);s=e.isFirst?0:u,c=window.setInterval((()=>{f(s%o),s>=i&&(window.clearInterval(c),u=0,p(t,n)),s++}),l)},setLotteryTime:function(t){e.LotteryTime=parseInt(t),g()}}},e.pjs_random=function(e,t){return Math.round(Math.random()*t+e)},e.random=i,e.setDomAttrubites=n,e.setDomStyles=t}));
