function e(e,n=(e=>{})){if(!window.html2canvas)return void console.log("function canvasImgInLocal need to introduce html2canvas.js!");let o=document.getElementById(e.canvasId);const i=o||document.documentElement.body;let l=[];e.hiddenCompIds&&(l=e.hiddenCompIds.split(",")),window.setTimeout((()=>{window.html2canvas(i,{backgroundColor:e.saveImgBgColor||null,useCORS:!0,async:!0,logging:!1,ignoreElements:e=>!!(l.length>0&&e.id&&l.indexOf(e.id)>-1)}).then((o=>{const i=t(o);if(e.repalceId){let t=document.getElementById(e.repalceId);if(t){if(t instanceof HTMLImageElement)t.src=i;else if(t instanceof HTMLCanvasElement){t.getContext("2d").drawImage(o,0,0)}}else console.log("canvas repalce dom can not find!")}n({canvas:o,url:i})}))}),e.timeOut||0)}function t(e,t="png",n=1){return t?e.toDataURL("image/"+t,Number(n)):e.toDataURL()}function n(e){const t=[0,1,2,7,8,3,6,5,4];let n=[],o=[],i=null,l=null,a=0,s=null,d=-1,r=null;if(e.id){let o=document.getElementById(e.id);if(setDomStyles(o,{display:"flex","justify-content":"space-between","align-items":"center","flex-wrap":"wrap"}),o){if(o.childNodes.length>0)return;for(let i=0;i<9;i++){let l,a,s=document.createElement("div");if(s.setAttribute("lottery_index",t[i]),e.itemWidth)l=getRealPx(e.itemWidth)+"px",a=getRealPx(e.itemHeight)+"px";else{let t=parseInt(o.offsetWidth),n=parseInt(o.offsetHeight),i=e.ratio?e.ratio:.99;l=t/3*i+"px",a=n/3*i+"px"}setDomStyles(s,{display:"inline-block",position:"relative",width:l,height:a,"flex-shrink":1});let d=document.createElement("img"),r=document.createElement("img");setDomStyles(d,{position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"none",zIndex:20}),setDomStyles(r,{position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:1}),e.lotteryList?(e.lotteryList[i]&&(setDomAttrubites(d,{src:e.lotteryList[i][0],lottery_status:"light"}),setDomAttrubites(r,{src:e.lotteryList[i][1],lottery_status:"unlight"})),s.appendChild(d),s.appendChild(r)):console.log("onLottery need params lotteryList!"),n.push(s),o.appendChild(s)}}else console.log("onLottery params need id")}if(e.time=!e.time||e.time<3?3:e.time,e.times=!e.times||e.times<2?2:e.times,n.length){let t=n.sort(((e,t)=>parseInt(e.getAttribute("lottery_index"))-parseInt(t.getAttribute("lottery_index"))));o=[...t],i=o.pop(),l=i.childNodes[0],e.onclick&&l.addEventListener("click",(function(t){if(t.preventDefault(),t.stopPropagation(),i){if(e.onclick){setDomStyles(l,{display:"none"}),(0,e.onclick)()}}else console.log("emitClick cant find lottery dom!")}))}function c(e){if(o.forEach((e=>{let t=e.childNodes[0];setDomStyles(t,{display:"none"})})),e>=0){const t=o[e];setDomStyles(t.childNodes[0],{display:"block"})}}function m(t,n=(()=>{})){t<0&&(t=e.thanksIndex);const i=o.length,l=i*(e.times-2)+t;if(c(a%i),l==d&&0==l)u(),n();else{const o=1e3*e.time,i=parseInt(e.time/2*1e3/l),c=parseInt(500*((s=(s=d*i)/o-1)*s*s+1)+300);r=window.setTimeout((()=>{m(t,n),a++,d++,d>=l&&(n(),u(),window.clearTimeout(r))}),c)}var s}function u(){let t={};e.LotteryTime>=1?t.display="block":t.display="none",setDomStyles(l,t)}return n.forEach(((t,n)=>{let o=parseInt(t.getAttribute("lottery_index")),i=t.childNodes[0],l=t.childNodes[1];8==o?e.LotteryTime>=1?setDomStyles(i,{display:"block"}):setDomStyles(i,{display:"none"}):(setDomStyles(i,{display:"none"}),setDomStyles(l,{display:"block"}))})),{start:function(t,n=(()=>{})){const i=o.length,l=i*e.times,r=parseInt(1e3*e.time/l);a=e.isFirst?0:d,s=window.setInterval((()=>{c(a%i),a>=l&&(window.clearInterval(s),d=0,m(t,n)),a++}),r)},setLotteryTime:function(t){e.LotteryTime=parseInt(t),u()}}}function o(e){if(!e.id)return console.log("function TwistedEggMatter need params of id "),null;if(!window.Matter)return void console.log("function TwistedEggMatter need to introduce Matter.js!");const t=e.imgs,n=getRealPx(e.ballWidth)*e.ratio,o=e.width,i=e.height,l=parseInt(e.gravityY);document.documentElement.style;let a=window.Matter,s=a.Engine,d=a.Render,r=a.Runner,c=a.World,m=a.Bodies,u=a.Composite,h=s.create(),g=document.getElementById(e.id);console.log(g);let p=d.create({element:g,engine:h,options:{width:getRealPx(o),height:getRealPx(i),wireframes:!1,background:"transparent"}});h.world.gravity.x=0,h.world.gravity.y=.5;const y=[];let f=-1,w=t.length,x=[122.78585140770514,209.3235376646257,326.01634544621396,101.52559109065926,188.39323934095015,282.38697650836866],v=[183.38542746227944,230.06200548401105,207.91038110198647,279.55905905222403,326.1084787517811,296.24269011459813];for(let l=0;l<w;l++){let a=o/400*x[l],s=i/400*v[l],d=m.circle(a,s,n/2,{friction:.001,frictionAir:.005,restitution:.9,density:.05,render:{strokeStyle:"red",lineWidth:0,sprite:{texture:t[l],xScale:e.scale?e.scale:.9,yScale:e.scale?e.scale:.9}}});y.push(d)}let I=Math.min(o,i),b=I*(1/4.5*2);const S=2*Math.PI;let E,C,k,L,M,D,R;for(f=0;f<64;f++)E=S/64,C=f/64*S+E/2,k=Math.cos(C),L=Math.sin(C),M=k*b+o/2,D=L*b+i/2,T({x:M,y:D,w:.01*I,h:.4*I,options:{angle:C,isStatic:!0,density:1,render:{fillStyle:"red",strokeStyle:"transparent",lineWidth:1}}});function T({x:e=0,y:t=0,w:n=10,h:o=10,options:i={}}={}){let l=m.rectangle(e,t,n,o,i);return function(...e){c.add(h.world,...e)}(l),l}return u.add(h.world,y),d.run(p),d.lookAt(p,u.allBodies(h.world)),{start:function(e=(()=>{})){R||(R=r.create()),r.run(R,h);let t=y,n=0;for(let e=0;e<2*t.length;e++)window.setTimeout((()=>{var n;n=t[e%t.length],a.Body.applyForce(n,n.position,{x:0,y:-Math.random()*l})}),n),n+=100;window.setTimeout((()=>{r.stop(R),e()}),3*n)}}}var i={width:750,height:1334,designScale:2,adaptiveScale:2,clientWidth:document.documentElement.clientWidth||document.body.clientWidth,clientHeight:document.documentElement.clientHeight||document.body.clientHeight};function l(e){if(!e.id)return void console.log("function Barrage need id!");let t="barrage",n="barrage-b",o=document.getElementById(e.id);if(setDomStyles(o,{position:"relative",overflow:"hidden"}),e.textSize=e.textSize||20,e.duration=e.duration||10,e.num=e.num||5,e.duration=e.duration||12,e.content)return this.content=e.content,function(){let i,a,s=content.length;time=s/2/e.num,s/2%e.num!=0&&(time+=1);for(a=0;a<Math.ceil(s/2);a++)i=l(content[a],t+"-"+Math.floor(a/e.num),a%e.num),o.appendChild(i);for(let t=0;t<Math.floor(s/2);t++)i=l(content[t+a],n+"-"+Math.floor(t/e.num),t%e.num),o.appendChild(i)}(),window.setTimeout((()=>{a("."+t+"-0",0,t),e.num>1&&window.setTimeout((()=>{a("."+n+"-0",0,n)}),1e3*e.duration/2)}),500),{destroy:function(){t="",n="",count=0,num=0,e=null,fontFamily="",document.getElementsByClassName("barrage-item").forEach((e=>{window.gsap.killTweensOf(e)}))}};function l(t,n,l){let a,s=e.fontColor,d=e.textSize,r=parseInt(o.clientWidth);if(Array.isArray(s)){let e=s.length,t=random(0,e-1);console.log(t),a=s[t]}else a=s||"black";if(Array.isArray(d)){let e=d.length;d=d[random(0,e-1)]/i.adaptiveScale}else d/=i.adaptiveScale;let c={position:"absolute",top:parseInt(o.clientHeight)/e.num*l+"px",left:r+"px",fontSize:d+"px",whiteSpace:"nowrap",color:a},m=document.createElement("span");return m.classList.add(n,"barrage-item"),setDomStyles(m,c),m.innerHTML=t,m}function a(t,n=0,i){e&&e.duration&&e.duration,window.gsap.to(t,{x:function(e){let n=document.querySelectorAll(t);return-(parseFloat(n[e].clientWidth)+parseFloat(o.clientWidth))},duration:e.duration,ease:"none",yoyo:!1,stagger:e.num,onComplete:function(){!function(e,t){window.gsap.to("."+e+"-"+t,{x:0,y:0,duration:0,delay:0})}(i,n);let e=n+1;e>=Math.floor(time)?a("."+i+"-0",0,i):a("."+i+"-"+e,e,i)}})}}async function a(e,t,n){let o=document.getElementById(e),i="";i=o?o.innerHTML||o.innerText:e,!function(e){const t=document.createElement("span");t.textContent=e,t.style.whiteSpace="pre",t.style.webkitUserSelect="auto",t.style.userSelect="all",document.body.appendChild(t);const n=window.getSelection(),o=window.document.createRange();n.removeAllRanges(),o.selectNode(t),n.addRange(o);let i=!1;try{i=window.document.execCommand("copy")}finally{n.removeAllRanges(),window.document.body.removeChild(t)}if(!i)throw makeError();return i}(i)?n&&n():t&&t(i)}function s(e={}){let{id:t,touchstart:n,touchend:o,touchmove:i,mask:l,zIndex:a}=e,s=document.getElementById(t),d=s.getBoundingClientRect().width,r=s.getBoundingClientRect().height,c=!1,m=document.createElement("canvas");if(_setDomStyles(m,{position:"absolute","z-index":a||1}),s.appendChild(m),m){ctx=m.getContext("2d"),ctx.imageSmoothingEnabled=!0,ctx.imageSmoothingQuality="high";const e=new Image;e.src=l,e.onload=()=>{const t=window.devicePixelRatio;m.width=d*t,m.height=r*t,ctx.drawImage(e,0,0,m.width,m.height),ctx.scale(t,t),m.style.width=`${d}px`,m.style.height=`${r}px`,ctx.globalCompositeOperation="destination-out"},m.addEventListener("touchstart",(function(e){c=!0,n&&n()})),m.addEventListener("touchend",(function(){c=!1,document.body.style.overflow="auto",o&&o()})),m.addEventListener("touchmove",(function(e){document.body.style.overflow="hidden",c&&function(e,t){const n=m.getBoundingClientRect(),o=t.touches[0].clientX-n.left,i=t.touches[0].clientY-n.top;e.beginPath(),e.arc(o,i,20,0,2*Math.PI,!0),e.fill(),e.closePath()}(ctx,e),c&&i&&i()}))}return{canvas:m,setMask:function(e="https://n.sinaimg.cn/auto/20240704zero/page4/mask.png"){if(!m)return;const t=new Image;t.src=e,t.onload=()=>{ctx.globalCompositeOperation="source-over";const e=window.devicePixelRatio;m.width=d*e,m.height=r*e,ctx.drawImage(t,0,0,d*e,r*e),ctx.scale(e,e),m.style.width=`${d}px`,m.style.height=`${r}px`,ctx.globalCompositeOperation="destination-out"}}}}i.adaptiveScale=i.width/i.clientWidth;export{l as Barrage,s as ScratchCard,o as TwistedEggMatter,e as canvasImgInLocal,a as clipboardCopy,t as getBase64ByType,n as onLotterty};
